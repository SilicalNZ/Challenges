data "'" + "' '".join(x.split("\n")) + "'"

+/{(96<⍵){(¯96+(⍺/⍵)),(¯38+((~⍺)/⍵))}⍵}⎕UCS{⊃⍵{(⍵↓⍺)∩(⍵↑⍺)}(⊃0.5×⍴⍵)}¨data

{({⍺, ⍴⍵}⌸¨¨⊃¨¨,/¨¨⍵)}⊃¨,/¨{⍵∘{⍵∘∩¨⍺~⊂⍵}¨⍵}¨data
